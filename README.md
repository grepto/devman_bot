# Мониторинг проверок уроков на [Devman'e](https://dvmn.org)
Скрипт контролирует появление новых результатов код-ревью на девмане и отправляет сообщение в телеграмм-чат
или в личку пользователю 


### Как установить
Для работы скрипта нужно зарегистрировать в операционной системе переменные окружения

- `TG_TOKEN` - Токен бота в телеграме
- `TG_CHAT_ID` - @Идентификатор телеграмм-чата или пользователя (например @smmreposting)

- `DEVMAN_TOKEN` Токен доступа пользователя к api Devman'a. Получать [тут](https://dvmn.org/api/docs/)
- `DEVMAN_ENDPOINT`= URL Devman'a (на данный момент https://dvmn.org)


- `LOG_LEVEL` - уровень логирования (NOTSET, DEBUG, INFO, WARNING, ERROR, CRITICAL). Подробно о каждом уровне
описано [тут](https://docs.python.org/3/library/logging.html)

 
Python3 должен быть уже установлен.
Затем используйте `pip` (или `pip3`, есть есть конфликт с Python2) для установки зависимостей:
```
pip install -r requirements.txt
```

### Как использовать
Запустить `main.py`


Пример использования
```bash
python main.py
```

### Деплой и запуск на Heroku
Бота можно запустить на [Heroku](https://.heroku.com). Нужно создать на Heroku новое приложение, связать его с
репозиторием, задеплоить и сбилдить исходники.

В настройках приложения на heroku (вкладка Settings) нужно добавить в Config Vars переменные окружения и их значения
описанные в разделе Как установить. Чтобы не забивать логи инстанса на heroku, `LOG_LEVEL` лучше выставить значение
`INFO`

После настройки приложение нужно запустить во вкладке `Resource`. Если скрипт запустится корректно, телеграм-бот пришлет
сообщение вида
```
2019-07-09 20:44:12,627
check_devman_attempts
INFO
Script started
```

Если произойдет ошибка бот напишет в телеграм сообщение вида
```
2019-07-09 23:11:43,125
check_devman_attempts
ERROR
division by zero
```

Для управления ботом на Heroku из коммандной строки нужно установить
[heroku cli](https://devcenter.heroku.com/categories/command-line) и авторизоваться из терминала в Heroku

Для проверки статуса приложения из терминала нужно выполнить команду
```sh
heroku ps -a название_приложения_на_heroku
```

### Цель проекта
Код написан в образовательных целях на онлайн-курсе для веб-разработчиков dvmn.org.